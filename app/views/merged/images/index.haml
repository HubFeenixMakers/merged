- content_for( :merged_menu ) do
  .text-xl.font-bold.text-gray-900
    All Images

= render "layouts/merged_header"
- if Rails.env.development?
  = javascript_include_tag "merged/vue.js"
-else
  = javascript_include_tag "merged/vue.min.js"

.images
  .flex.justify-center
    %label.block
      .mt-1.mx-4.text-lg.font-bold Search
    %input.border.rounded{:category => "query", placeholder:"by name", "v-model" => "search_name" }

  .grid.grid-cols-6.gap-4.m-8
    .flex.flex-col.border.border-gray-100.rounded.image_box{"v-for": "image in filter_and_sort"}
      .flex.align-center.justify-between.mb-4
        .text-lg.font-bold.mt-2.mx-2
          {{image.name}}
        %strong.inline-block.rounded.bg-yellow-200.px-3.py-1.text-md.font-medium
          {{image.aspect_ratio}}
      .w-full.object-contain.h-72
        %img{ ":src": "image.url" , ":alt": "image.name" }
      .flex.justify-between.mb-8
        %strong.inline-block.rounded.bg-orange-50.px-3.py-1.text-md.font-medium
          {{image.size}}
        %strong.inline-block.rounded.bg-orange-50.px-3.py-1.text-md.font-medium
          {{image.created_at}}
        %strong.rounded.h-10.bg-orange-50.px-5.py-2.font-medium
          {{image.type}}

%script{:src => "https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"}

:ruby2js
  class Images < Vue
    options el: '.images'
    def initialize
      @image_data = #{@image_data.to_json.html_safe}
      @search_name = ""
    end
    def filter_and_sort
      dat = @image_data
      return dat unless @search_name.length > 0
      dat = dat.filter do |item|
        return item["name"].toLowerCase().indexOf(@search_name) > -1
      end
      dat
    end
  end
